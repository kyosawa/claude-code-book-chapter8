# プロダクト要求定義書 (Product Requirements Document)

## プロダクト概要

### 名称
**TaskCLI** - Gitと一体化した開発者向けタスク管理CLIツール

### プロダクトコンセプト
- **ターミナル完結**: GUI不要でタスク管理のすべての操作をコマンドラインで完結する
- **Gitとの一体感**: タスクとGitブランチが1対1で紐付き、コミット・PR・マージとタスクが自動連携する
- **開発フローへの溶け込み**: タスク開始→ブランチ作成→コミット→PR→マージ→タスク完了という一連の流れを自動化・支援する

### プロダクトビジョン
開発者がターミナルから離れることなく、効率的にタスクを管理できるCLIツールを提供する。
GUIのタスク管理ツールとターミナルを頻繁に切り替えることによる集中力の断絶をなくし、開発作業とタスク管理をシームレスにつなぐ。
Gitブランチとタスクを自動紐付けすることで、「どのタスクのために今どのブランチで作業しているか」を常に明確にし、手動管理の手間を排除する。
JiraやAsanaのような重厚なツールではなく、開発者が本当に必要な機能だけを提供し、インストールから5分以内に使い始められるシンプルさを目指す。

### 目的
- コンテキストスイッチ(GUI↔ターミナルの切り替え)を排除し、開発者の集中力を維持する
- タスクとGitの連携を自動化し、手動でのステータス更新・ブランチ作成・コミットメッセージ記入の手間をなくす
- 個人開発者から小規模チームまで、シンプルかつ高速に使えるタスク管理基盤を提供する

---

## ターゲットユーザー

### プライマリーペルソナ: 個人開発者（25〜35歳、フリーランスエンジニア）

- 開発歴5年以上でCLI操作に慣れており、複数プロジェクトを並行して進めている
- Vim/VSCode + ターミナル環境で作業し、ブラウザとターミナルの切り替えを極力減らしたい
- **現在の課題**: 複数プロジェクトのタスクが頭の中だけで管理されており、「次に何をするか」を毎回考え直す必要がある。GitHub Issuesは使っているがローカル作業との連携ができていない
- **期待する解決策**: ターミナルで完結するタスク管理、Gitブランチとの自動連携、シンプルで速いインターフェース
- **典型的なワークフロー**: ターミナルを開く → タスク一覧確認 → タスク開始(ブランチ自動作成) → コード実装 → コミット → タスク完了(PR自動作成)

### セカンダリーペルソナ: 小規模チームリーダー（30〜40歳、テックリード）

- チーム規模2〜5人のスタートアップ、開発歴10年以上、マネジメント経験あり
- **現在の課題**: チームメンバーの進捗をリアルタイムで確認したいが、GUIツールを開かないと分からない。JiraやAsanaは小規模チームには大げさすぎる
- **期待する解決策**: CLIでチーム全体のタスク状況を確認できる、GitHub連携で自動的に進捗更新、軽量で導入が楽
- **典型的なワークフロー**: 朝会前にターミナルでチームのタスク状況を確認 → 各自がタスクをスタート → 完了時に自動でPR作成

---

## 成功指標(KPI)

### プライマリーKPI
- **アクティブユーザー数**: リリース後3ヶ月で100人のDAU
- **継続率**: 1ヶ月後も使い続けているユーザーが60%以上
- **GitHub Stars**: リリース後6ヶ月で500以上

### セカンダリーKPI
- **導入率**: 開発者10人に紹介して3人以上が1週間継続使用
- **満足度**: Net Promoter Score (NPS) 30以上
- **時間削減**: タスク管理にかかる時間が使用前比で50%削減（リリース後3ヶ月時点で10名以上を対象にユーザーインタビューを実施し測定。基準値は「1日あたりのGUI↔ターミナル切り替え回数」と「タスクステータス更新にかかる時間」で計測）

---

## 機能要件

### コア機能(MVP)

#### 1. タスクの基本CRUD操作

**ユーザーストーリー**:
開発者として、作業内容をタスクとして記録・管理するために、コマンドラインでタスクの作成・一覧・詳細表示・完了・削除ができる機能が欲しい

**受け入れ条件**:
- [ ] `task add "タイトル"` でタスクを作成でき、一意のIDが自動採番される
- [ ] `task list` で全タスクをID・ステータス・タイトル・紐付きブランチ形式で一覧表示できる
- [ ] `task show <id>` でタスクの全詳細(タイトル・ステータス・説明・作成日・ブランチ)を確認できる
- [ ] `task done <id>` でタスクを完了状態に変更できる
- [ ] `task delete <id>` で確認プロンプトの後にタスクを削除できる
- [ ] タスクデータは `.task/tasks.json` に保存され、コマンド実行後も永続化される

**優先度**: P0(必須)

---

#### 2. タスクステータス管理

**ユーザーストーリー**:
開発者として、今どのタスクがどの状態にあるかを把握するために、タスクのステータスを管理できる機能が欲しい

**受け入れ条件**:
- [ ] タスクは `open`(新規)・`in_progress`(作業中)・`completed`(完了)・`archived`(アーカイブ)の4ステータスを持つ
- [ ] `task list --status <status>` でステータス別にフィルタリングして表示できる
- [ ] ステータス変更は自動(タスク開始・完了時)と手動の両方に対応する

**優先度**: P0(必須)

---

#### 3. Gitブランチとの自動連携

**ユーザーストーリー**:
開発者として、タスクとGitブランチを明確に紐付けて管理するために、タスク開始時に自動でブランチを作成・切り替えできる機能が欲しい

**受け入れ条件**:
- [ ] `task start <id>` を実行すると `feature/task-<id>-<タイトルのslug>` ブランチが自動作成される
- [ ] ブランチ作成後、自動でそのブランチに切り替わる
- [ ] `task list` の表示に現在タスクに紐付いたブランチ名が表示される
- [ ] Gitリポジトリが存在しない環境では、ブランチ連携なしでタスク管理のみ動作する

**優先度**: P0(必須)

---

#### 4. シンプルなタスク一覧表示

**ユーザーストーリー**:
開発者として、全タスクの状態を素早く把握するために、見やすい一覧形式でタスクを確認できる機能が欲しい

**受け入れ条件**:
- [ ] `task list` の出力フォーマットが `ID | Status | Title | Branch` の列形式で表示される
- [ ] 1000件のタスクを1秒以内に表示できる
- [ ] ステータス別に色分け表示される(in_progress:黄色、completed:緑、open:白)

**優先度**: P0(必須)

---

### CLIインターフェース

```bash
# タスクの基本操作(MVP)
task add "ユーザー認証機能の実装"
task add "緊急バグ修正" --priority high --due 2025-01-20
task list
task list --status in_progress
task show 1
task start 1
# → 自動で feature/task-1-user-authentication ブランチを作成・切り替え
task done 1
task archive 1
task delete 1

# GitHub Issues連携(P1)
task sync
task import --github

# 検索・絞り込み(P1)
task search "認証"
task list --sort priority  # 優先度順ソート(昇順: low→high)

# チーム機能(P2)
task list --team
task assign 1 @alice
```

---

### 将来的な機能(Post-MVP)

#### 5. GitHub Issues連携

`task sync` でローカルタスクとGitHub Issuesを同期し、`task import --github` でIssuesからタスクをインポートできる。Personal Access Tokenで認証し、GitHub REST API v3を使用する。

**最低限の受け入れ条件**（詳細はP1フェーズ設計時に定義）:
- [ ] `TASKCLI_GITHUB_TOKEN` 環境変数が設定済みの場合、`task sync` が実行できる
- [ ] `task import --github` でGitHub Issuesをローカルタスクに取り込める
- [ ] 同期失敗時（認証エラー・ネットワークエラー）にわかりやすいエラーメッセージを表示する

**優先度**: P1(重要)

---

#### 6. タスク完了時の自動処理

`task done <id>` 実行時に、ブランチをmainにマージ・リモートにプッシュ・GitHub PRの自動作成をオプションで実行できる。

**最低限の受け入れ条件**（詳細はP1フェーズ設計時に定義）:
- [ ] `task done <id> --create-pr` でGitHub PRを自動作成できる
- [ ] PR作成失敗時はタスクのステータス変更のみ行い、エラーを表示する

**優先度**: P1(重要)

---

#### 7. タスクの絞り込み・検索

`task search "キーワード"` でタイトル・説明文を全文検索できる。`task list --sort priority` で優先度順に表示できる。

**優先度**: P1(重要)

---

#### 8. 優先度と期限の管理

`task add "タスク名" --priority high --due 2025-01-20` で優先度と期限を設定できる。期限切れのタスクを警告表示する。

**優先度**: P1(重要)

---

#### 9. チーム機能

`task list --team` でチームメンバー全員のタスク一覧を表示できる。`task assign <id> @username` でタスクをアサインできる。

**優先度**: P2(できれば)

---

#### 10. 作業時間の記録

`task start <id>` で計測開始、`task done <id>` で作業時間を自動記録・表示する。

**優先度**: P2(できれば)

---

#### 11. カレンダー表示

`task calendar --week` / `task calendar --month` でタスクをカレンダー形式で表示できる。

**優先度**: P2(できれば)

---

#### 12. タスクテンプレート

`task template create <name>` でテンプレートを作成し、`task add --template <name> "タイトル"` でテンプレートからタスクを作成できる。

**優先度**: P2(できれば)

---

## 非機能要件

### パフォーマンス
- コマンド実行時間: 100ms以内（測定環境: CPU Core i5相当・メモリ8GB・SSD）
- タスク一覧表示: 1000件まで1秒以内（同環境）
- GitHub API連携コマンド: 3秒以内(ネットワーク遅延除く)
- 詳細な測定方法・環境定義は `docs/architecture.md` のパフォーマンス要件を参照

### ユーザビリティ
- 新規ユーザーが `--help` を読んで5分以内に基本操作(add/list/start/done)を習得できる
- すべてのコマンドにヘルプテキスト(`--help`)が提供される
- エラーメッセージは問題の内容と解決方法を明示する(例: `Error: Git repository not found. Run 'git init' first.`)

### 信頼性
- タスクデータの自動バックアップ(変更前に `.task/backup/` へバックアップ)
- 削除・完了操作は確認プロンプトを表示してからデータを変更する
- Git操作失敗時はタスクのステータスをロールバックする

### セキュリティ
- GitHub Personal Access Tokenは環境変数(`TASKCLI_GITHUB_TOKEN`)で管理し、設定ファイルに平文保存しない
- `.task/` ディレクトリのファイルパーミッションは600(オーナーのみ読み書き)

### スケーラビリティ
- MVPはJSONファイルでデータ管理し、タスク数が増加した場合にSQLiteへ移行できる設計にする
- プラグインシステムのためのフック機構(将来的に実装)を設計段階で考慮する

### クロスプラットフォーム
- macOS・Linux・Windows(Git Bash/WSL)で動作すること
- Node.js v18以上をサポート（推奨: v24.x LTS）

---

## スコープ外

明示的にスコープ外とする項目:
- GUIインターフェース(Web UI、デスクトップアプリ)
- GitLab・Bitbucketとの連携(MVP時点では未対応)
- クラウド専用の同期サービス(GitリポジトリのGit経由同期のみ対応)
- 有料プラン・課金機能(MVP時点では完全無料オープンソース)
- モバイルアプリ
